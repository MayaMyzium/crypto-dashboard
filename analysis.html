<script type="text/javascript">
        var gk_isXlsx = false;
        var gk_xlsxFileLookup = {};
        var gk_fileData = {};
        function filledCell(cell) {
          return cell !== '' && cell != null;
        }
        function loadFileData(filename) {
        if (gk_isXlsx && gk_xlsxFileLookup[filename]) {
            try {
                var workbook = XLSX.read(gk_fileData[filename], { type: 'base64' });
                var firstSheetName = workbook.SheetNames[0];
                var worksheet = workbook.Sheets[firstSheetName];

                // Convert sheet to JSON to filter blank rows
                var jsonData = XLSX.utils.sheet_to_json(worksheet, { header: 1, blankrows: false, defval: '' });
                // Filter out blank rows (rows where all cells are empty, null, or undefined)
                var filteredData = jsonData.filter(row => row.some(filledCell));

                // Heuristic to find the header row by ignoring rows with fewer filled cells than the next row
                var headerRowIndex = filteredData.findIndex((row, index) =>
                  row.filter(filledCell).length >= filteredData[index + 1]?.filter(filledCell).length
                );
                // Fallback
                if (headerRowIndex === -1 || headerRowIndex > 25) {
                  headerRowIndex = 0;
                }

                // Convert filtered JSON back to CSV
                var csv = XLSX.utils.aoa_to_sheet(filteredData.slice(headerRowIndex)); // Create a new sheet from filtered array of arrays
                csv = XLSX.utils.sheet_to_csv(csv, { header: 1 });
                return csv;
            } catch (e) {
                console.error(e);
                return "";
            }
        }
        return gk_fileData[filename] || "";
        }
        </script><!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>永續合約做多／做空分析</title>
  <link rel="stylesheet" href="style.css">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="analysis.js" defer></script>
</head>
<body>
  <header>
    <h1>永續合約做多／做空分析</h1>
    <p>本頁面統整幣安與 Bybit 兩大交易所的做多／做空永續合約資訊，以表格呈現每種虛擬貨幣的多空比率、變化量與資金費率，並計算情緒分數。下方再以折線圖顯示過去一週情緒分數的變化趨勢。</p>
  </header>

  <section>
    <p>下列表格呈現幣安與 Bybit 交易所永續合約的多空比率、其變化量，以及每個平台的資金費率和依據您提供公式計算出的「情緒分數」。為簡化閱讀，每種虛擬貨幣僅列出最近三筆多空比率資料。比率大於 1 表示多倉佔比較高，反之則為空倉佔比較高；資金費率以小數百分比顯示。情緒分數（SS）範圍 -1 至 +1，用來綜合評估市場情緒。</p>
    <div id="analysis-container"></div>
  </section>

  <section>
    <h2>情緒分數一週走勢</h2>
    <p>以下折線圖根據您提供的公式，計算出過去一週每小時的情緒分數（SS）。每條線代表一種虛擬貨幣，數值越大代表看多情緒越強，越小代表看空情緒越強。</p>
    <div class="chart-container">
      <canvas id="sentimentChart"></canvas>
    </div>
  </section>

  <section>
    <h2>幣別 CETS 分析結果</h2>
    <p>根據各幣種的專屬 CETS 模型，以下表格展示目前的 CETS 值與判斷區間，系統每 10 分鐘自動更新一次。</p>
    <table class="crypto-table">
      <thead>
        <tr>
          <th>幣種</th>
          <th>CETS 值</th>
          <th>判斷區間</th>
        </tr>
      </thead>
      <tbody>
        <tr><td>BTC</td><td id="cets-value-btc">--</td><td id="cets-category-btc">--</td></tr>
        <tr><td>ETH</td><td id="cets-value-eth">--</td><td id="cets-category-eth">--</td></tr>
        <tr><td>XRP</td><td id="cets-value-xrp">--</td><td id="cets-category-xrp">--</td></tr>
        <tr><td>DOGE</td><td id="cets-value-doge">--</td><td id="cets-category-doge">--</td></tr>
        <tr><td>ADA</td><td id="cets-value-ada">--</td><td id="cets-category-ada">--</td></tr>
        <tr><td>SOL</td><td id="cets-value-sol">--</td><td id="cets-category-sol">--</td></tr>
      </tbody>
    </table>
  </section>

  <section>
    <h2>幣別 TS 分析結果</h2>
    <p>以下為根據 TS 多因子公式計算的即時結果，系統每 10 分鐘自動更新一次。TS > 0.6 為強烈看漲；0.3 ≤ TS ≤ 0.6 為中性；TS < 0.3 為看跌。</p>
    <table class="crypto-table">
      <thead>
        <tr>
          <th>幣種</th>
          <th>TS 值</th>
          <th>判斷</th>
        </tr>
      </thead>
      <tbody>
        <tr><td>BTC</td><td id="ts-value-btc">--</td><td id="ts-category-btc">--</td></tr>
        <tr><td>ETH</td><td id="ts-value-eth">--</td><td id="ts-category-eth">--</td></tr>
        <tr><td>XRP</td><td id="ts-value-xrp">--</td><td id="ts-category-xrp">--</td></tr>
        <tr><td>DOGE</td><td id="ts-value-doge">--</td><td id="ts-category-doge">--</td></tr>
        <tr><td>ADA</td><td id="ts-value-ada">--</td><td id="ts-category-ada">--</td></tr>
        <tr><td>SOL</td><td id="ts-value-sol">--</td><td id="ts-category-sol">--</td></tr>
      </tbody>
    </table>
  </section>

  <section id="girg-section">
    <h2>美國及全球經濟衰退風險：GIRG 計算與結果</h2>
    <p>根據 Grok Integrated Recession Gauge (GIRG) 公式計算的即時結果，系統每日自動更新一次（凌晨 00:01）。GIRG &lt; 0.5 為綠燈（穩定）；0.5 ≤ GIRG &lt; 1.0 為黃燈（警戒）；GIRG ≥ 1.0 為紅燈（高風險衰退）。資料來源包括 FRED（Sahm 指標、殖利率曲線）、ISM（US PMI）、S&P Global（全球 PMI）。</p>
    <table class="crypto-table">
      <thead>
        <tr>
          <th>指標</th>
          <th>值</th>
          <th>判斷</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>GIRG 值</td>
          <td id="girg-value">--</td>
          <td id="girg-category">--</td>
        </tr>
        <tr>
          <td>Sahm 指標 (S)</td>
          <td id="girg-s">--</td>
          <td></td>
        </tr>
        <tr>
          <td>US 製造業 PMI</td>
          <td id="girg-us-pmi">--</td>
          <td></td>
        </tr>
        <tr>
          <td>殖利率曲線 (YC, 10Y-2Y)</td>
          <td id="girg-yc">--</td>
          <td></td>
        </tr>
        <tr>
          <td>全球製造業 PMI</td>
          <td id="girg-global-pmi">--</td>
          <td></td>
        </tr>
      </tbody>
    </table>
  </section>

  <section>
    <a href="index.html" class="btn">返回儀表板</a>
  </section>
</body>
</html>